module CanonicalEquivalence.ProofSystem where
open import CanonicalEquivalence.Prelude
open import CanonicalEquivalence.Syntax
open import CanonicalEquivalence.Helpers

-- Fixities
infix 5 _โข_
infix 7 _โ_

data _โข_ (ฮ : Theory) : Formula โ Set where
  assumption : โ {ฯ}         โ ฮ ฯ โ ฮ โข ฯ
  -- Implication
  โโฑ         : โ {ฯ ฯ}       โ (ฯ :: ฮ) โข ฯ โ ฮ โข (ฯ โ ฯ)
  โแต         : โ {ฯ ฯ}       โ ฮ โข (ฯ โ ฯ) โ ฮ โข ฯ โ ฮ โข ฯ
  -- Disjunction
  โจiยน        : โ {ฯ ฯ}       โ ฮ โข ฯ โ ฮ โข (ฯ โจ ฯ)
  โจiยฒ        : โ {ฯ ฯ}       โ ฮ โข ฯ โ ฮ โข (ฯ โจ ฯ)
  โจแต         : โ (ฯ ฯ ฯ : Formula) โ ฮ โข (ฯ โจ ฯ) โ (ฯ :: ฮ) โข ฯ โ (ฯ :: ฮ) โข ฯ โ ฮ โข ฯ
  -- Conjunction
  โงโฑ         : โ {ฯ ฯ}       โ ฮ โข ฯ โ ฮ โข ฯ โ ฮ โข (ฯ โง ฯ)
  โงeยน        : โ {ฯ ฯ}       โ ฮ โข (ฯ โง ฯ) โ ฮ โข ฯ
  โงeยฒ        : โ {ฯ ฯ}       โ ฮ โข (ฯ โง ฯ) โ ฮ โข ฯ
  -- Bottom
  ๐แต         : โ {ฯ}         โ ฮ โข ๐ โ ฮ โข ฯ

-- Lifting derivations along subset inclusions
_โ_ : โ {ฮ ฮ ฯ} โ ฮ โ ฮ โ ฮ โข ฯ โ ฮ โข ฯ

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (assumption pf) = assumption (ฮโฮ pf)

_โ_ {ฮ} {ฮ} {ฯโ โ ฯโ} ฮโฮ (โโฑ xโ) = โโฑ ((extend-โ {ฮ = ฮ} {ฮ = ฮ} ฮโฮ) โ xโ)

_โ_ {ฮ} {ฮ} {ฯโ} ฮโฮ (โแต xโ xโ) = โแต (ฮโฮ โ xโ) (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โจiยน xโ) = โจiยน (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โจiยฒ xโ) = โจiยฒ (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โจแต ฯโ ฯ ฯ xโ xโ xโ) = โจแต ฯโ ฯ ฯ (ฮโฮ โ xโ) ((extend-โ {ฮ = ฮ} {ฮ = ฮ} ฮโฮ) โ xโ) ((extend-โ {ฮ = ฮ} {ฮ = ฮ} ฮโฮ) โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โงโฑ xโ xโ) = โงโฑ (ฮโฮ โ xโ) (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โงeยน xโ) = โงeยน (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (โงeยฒ xโ) = โงeยฒ (ฮโฮ โ xโ)

_โ_ {ฮ} {ฮ} {ฯ} ฮโฮ (๐แต xโ) = ๐แต (ฮโฮ โ xโ)
